<div class="dashboard-container" *ngIf="!loading">

<!-- ===============================
     Dashboard Intro
     =============================== -->
<div class="card employee-header">
  <h1>Employee Skill Dashboard</h1>
  <p class="subtitle">
    Analyze skill readiness, identify gaps for target roles,
    and plan next steps using data-driven insights.
  </p>
</div>

<!-- ===============================
     Employee Snapshot
     =============================== -->
<div class="card  dashboard-intro">
  <h2>{{ employee.job_title }}</h2>
  <p class="meta">
    {{ employee.industry }} · {{ employee.work_type }} ·
    {{ employee.experience_years }} yrs experience
  </p>
</div>


  <!-- ===============================
       Main Grid
       =============================== -->
  <div class="dashboard-grid">

    <!-- My Skills -->
    <div class="card skills-card">
      <h3>My Skills</h3>

      <div class="skills">
        <span class="skill-chip" *ngFor="let skill of employee.skills">
          {{ skill }}
        </span>
      </div>

      <a [routerLink]="['/employee/skills']" class="link">
        Edit Skills
      </a>
    </div>

    <!-- Skill Gap Analysis -->
    <div class="card skill-gap-card">
      <div class="skill-gap-header">
        <h3>Skill Gap Analysis</h3>
        <p class="subtitle">
          Compare your current skills with a target role to identify gaps.
        </p>
      </div>

      <!-- Controls -->
      <div class="gap-controls">
        <label for="role">Target Role</label>

        <div class="control-row">
          <select id="role" [(ngModel)]="selectedRole">
            <option value="" disabled selected>
              Select a role
            </option>
            <option *ngFor="let role of roles" [value]="role.title">
              {{ role.title }}
            </option>
          </select>

          <button
            class="analyze-btn"
            (click)="analyzeGap()"
            [disabled]="!selectedRole">
            Analyze
          </button>
        </div>
      </div>

      <!-- Results -->
      <div *ngIf="gapResult" class="gap-results">

        <!-- Matched -->
        <div class="result-section">
          <h4>Matched Skills</h4>

          <div class="skill-list"
               *ngIf="gapResult.matched_skills.length > 0; else noMatch">
            <span class="skill matched"
                  *ngFor="let s of gapResult.matched_skills">
              {{ s }}
            </span>
          </div>

          <ng-template #noMatch>
            <p class="empty-text">No matching skills yet.</p>
          </ng-template>
        </div>

        <!-- Missing -->
        <div class="result-section">
          <h4>Missing Skills</h4>

          <div class="missing-list">
            <div class="missing-skill"
                 *ngFor="let m of gapResult.missing_skills">
              <span class="skill-name">{{ m.skill }}</span>
              <span class="badge" [ngClass]="m.priority.toLowerCase()">
                {{ m.priority }}
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>

  <!-- ===============================
       Actions
       =============================== -->
  <div class="card actions-card">
    <h3>Next Actions</h3>

    <div class="action-list">
      <a routerLink="/recommend" class="action-btn">
        Generate AI Recommendation
      </a>

      <a routerLink="/recommend/history" class="action-btn secondary">
        View Recommendation History
      </a>
    </div>
  </div>

  <!-- ===============================
       Explore
       =============================== -->
  <div class="card explore-card">
    <h3>Explore</h3>
    <a routerLink="/global-dashboard" class="link">
      Global Skills & Roles Intelligence
    </a>
  </div>

</div>

<div *ngIf="loading" class="loading">
  Loading dashboard...
</div>
